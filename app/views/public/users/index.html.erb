<h1>ユーザー一覧</h1>

<!-- 検索フォーム -->
<form action="<%= search_users_path %>" method="get" class="d-flex mb-3">
  <input type="text" name="query" class="form-control" placeholder="ユーザー名で検索">
  <button type="submit" class="btn btn-primary ms-2">検索</button>
</form>

<!-- 検索結果を表示 -->
<% if @query.present? %>
  <h2>「<%= @query %>」の検索結果</h2>
<% end %>

<% if @users.any? %>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>プロフィール画像</th> <!-- 画像の列を追加 -->
        <th>名前</th>
        <th>登録日</th>
        <th>アクション</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td>
          <% if user.profile_image.attached? %>
          <%= image_tag user.profile_image.variant(resize_to_fill: [200, 200]), class: "profile-image-small" %>
          <% else %>
          <%= image_tag "no_image.jpg", class: "profile-image-small", width: 200, height: 200 %>
          <% end %>
          </td>
          <td> <%= link_to user.name, user_path(user), class: "text-decoration-none" %></td>
          <td><%= user.created_at.strftime("%Y/%m/%d") %></td>
          <td><%= link_to "プロフィールを見る", user_path(user), class: "btn btn-info btn-sm" %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p>該当するユーザーが見つかりませんでした。</p>
<% end %>

<%= link_to "ユーザー一覧へ戻る", users_path, class: "btn btn-outline-secondary mt-3" %>