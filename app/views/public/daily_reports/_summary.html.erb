<h3>成長サマリー</h3>

<div class="row">
  <!-- 技術の成長要約 -->
  <div class="col-md-4">
    <h4>技術トレンド</h4>
    <ul>
      <% @daily_reports.last(5).each do |report| %>
        <li><strong><%= report.date.strftime("%Y年%m月%d日") %></strong> - <%= report.skill_tags.map(&:name).join(", ") %></li>
      <% end %>
    </ul>
  </div>

  <!-- スキル習熟度の変化 -->
  <div class="col-md-4">
    <h4>スキル成長</h4>
    <canvas id="skillGrowthChart"></canvas>
  </div>

  <!-- 作業効率データ -->
  <div class="col-md-4">
    <h4>作業効率分析</h4>
    <canvas id="efficiencyChart"></canvas>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  let skillCtx = document.getElementById('skillGrowthChart');
  let efficiencyCtx = document.getElementById('efficiencyChart');

  if (skillCtx) {
    fetch('/daily_reports/skill_growth_data.json')
      .then(response => response.json())
      .then(data => {
        new Chart(skillCtx, {
          type: 'bar',
          data: {
            labels: data.skills,
            datasets: [{
              label: "成長度",
              data: data.levels,
              backgroundColor: "rgba(54, 162, 235, 0.6)"
            }]
          },
          options: { responsive: true }
        });
      });
  }

  if (efficiencyCtx) {
    fetch('/daily_reports/efficiency_data.json')
      .then(response => response.json())
      .then(data => {
        new Chart(efficiencyCtx, {
          type: 'line',
          data: {
            labels: data.dates,
            datasets: [{
              label: "コード行数",
              data: data.code_lines,
              borderColor: "rgba(75, 192, 192, 1)",
              fill: false
            }]
          },
          options: { responsive: true }
        });
      });
  }
});
</script>