<h1>„É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜ</h1>

<div class="mb-3">
  <!-- „Éï„Ç£„É´„Çø„Éú„Çø„É≥ÔºàÊ®™‰∏¶„Å≥„ÄÅÊäò„ÇäËøî„ÅóÂèØËÉΩÔºâ -->
  <div class="d-flex flex-wrap gap-2 mb-2">
    <%= link_to "Êñ∞„Åó„ÅÑÈ†Ü", admin_users_path(sort: "newest"), class: "btn btn-outline-primary" %>
    <%= link_to "Âè§„ÅÑÈ†Ü", admin_users_path(sort: "oldest"), class: "btn btn-outline-primary" %>
    <%= link_to "„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„É¶„Éº„Ç∂„Éº„ÅÆ„Åø", admin_users_path(filter: "active"), class: "btn btn-outline-success" %>
    <%= link_to "ÈÄöÂ†±Ê∏à„Åø„É¶„Éº„Ç∂„Éº„ÅÆ„ÅøË°®Á§∫", admin_users_path(filter: "reported"), class: "btn btn-outline-danger" %>
    <%= link_to "„Åô„Åπ„Å¶„ÅÆ„É¶„Éº„Ç∂„ÉºË°®Á§∫", admin_users_path, class: "btn btn-secondary" %>
  </div>

  <!-- Ê§úÁ¥¢„Éï„Ç©„Éº„É†ÔºöÊ§úÁ¥¢„Éê„Éº„Å®Ê§úÁ¥¢„Éú„Çø„É≥„ÇíÂêå‰∏ÄË°å„Å´Ê∞¥Âπ≥ÈÖçÁΩÆ -->
  <%= form_with url: search_admin_users_path, method: :get, local: true, html: { class: "input-group align-items-center" } do |f| %>
    <%= f.text_field :query, class: "form-control", placeholder: "„É¶„Éº„Ç∂„ÉºÂêç„ÅßÊ§úÁ¥¢" %>
    <div class="input-group-append">
      <%= f.submit "Ê§úÁ¥¢", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>

<table class="table table-hover">
  <thead class="table-dark text-center">
    <tr>
      <th>„Éó„É≠„Éï„Ç£„Éº„É´</th>
      <th>„É¶„Éº„Ç∂„ÉºÂêç</th>
      <th>„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ</th>
      <th>„Çπ„ÉÜ„Éº„Çø„Çπ</th>
      <th>„Éï„Ç©„É≠„Éº / „Éï„Ç©„É≠„ÉØ„Éº</th>
      <th>ÈÄöÂ†±Áä∂Ê≥Å</th>
      <th>„Ç¢„ÇØ„Ç∑„Éß„É≥</th>
    </tr>
  </thead>
  <tbody>
    <% @users.each do |user| %>
      <tr class="align-middle <%= 'table-warning' if user.reported %>">
        <!-- „Éó„É≠„Éï„Ç£„Éº„É´ÁîªÂÉèÔºöÂõ∫ÂÆö„Çµ„Ç§„Ç∫„Éª‰∏≠Â§ÆÂØÑ„Åõ -->
        <td class="text-center">
          <% if user.profile_image.attached? %>
            <%= image_tag user.profile_image.variant(resize_to_fill: [40, 40]),
                  class: "rounded-circle border",
                  style: "width: 40px; height: 40px; object-fit: cover;" %>
          <% else %>
            <%= image_tag "no_image.jpg",
                  class: "rounded-circle border",
                  style: "width: 40px; height: 40px; object-fit: cover;" %>
          <% end %>
        </td>

        <!-- „É¶„Éº„Ç∂„ÉºÂêç -->
        <td class="text-center">
          <%= link_to user.name, admin_user_path(user), class: "fw-bold text-dark" %>
        </td>

        <!-- „É°„Éº„É´„Ç¢„Éâ„É¨„Çπ -->
        <td class="text-center"><%= user.email %></td>

        <!-- „Çπ„ÉÜ„Éº„Çø„Çπ -->
        <td class="text-center">
          <% if user.status_before_type_cast == 0 %>
            <span class="badge bg-success">„Ç¢„ÇØ„ÉÜ„Ç£„Éñ</span>
          <% else %>
            <span class="badge bg-danger">ÈÄÄ‰ºöÊ∏à„Åø</span>
          <% end %>
        </td>

        <!-- „Éï„Ç©„É≠„Éº / „Éï„Ç©„É≠„ÉØ„Éº -->
        <td class="text-center">
          <span class="badge bg-info">„Éï„Ç©„É≠„Éº: <%= user.following.count %></span>
          <span class="badge bg-success">„Éï„Ç©„É≠„ÉØ„Éº: <%= user.followers.count %></span>
          <br>
          <%= link_to "#{user.name} „Åï„Çì„ÅÆ„Éï„Ç©„É≠„ÉºÈñ¢‰øÇ", following_admin_user_path(user),
                      class: "btn btn-outline-primary btn-sm mt-1" %>
        </td>

        <!-- ÈÄöÂ†±Áä∂Ê≥Å -->
        <td data-label="ÈÄöÂ†±Áä∂Ê≥Å" class="text-center">
          <% if user.reported %>
            <span class="badge bg-danger">
              <i class="bi bi-flag-fill me-1"></i>ÈÄöÂ†±Ê∏à„Åø
            </span>
          <% else %>
            <span class="badge bg-success">Ê≠£Â∏∏</span>
          <% end %>
        </td>
      

        <!-- „Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
        <td class="text-center">
          <div class="btn-group" role="group">
            <%= link_to "Ë©≥Á¥∞", admin_user_path(user), class: "btn btn-primary btn-sm" %>
            <% if user.status == "active" %>
              <%= link_to "üóëÔ∏èÂâäÈô§", admin_user_path(user),
                    method: :delete,
                    class: "btn btn-danger btn-sm",
                    data: { confirm: "‚ö†Ô∏è Êú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" } %>
            <% end %>
            <%= link_to(
                  user.status == "active" ? "‚õî ÁÑ°ÂäπÂåñ" : "‚úÖ ÊúâÂäπÂåñ",
                  toggle_status_admin_user_path(user),
                  method: :patch,
                  class: user.status == "active" ? "btn btn-warning btn-sm" : "btn btn-success btn-sm",
                  data: { confirm: "#{user.name} „ÅÆ„Ç¢„Ç´„Ç¶„É≥„Éà„Çí#{user.status == 'active' ? 'ÁÑ°ÂäπÂåñ' : 'ÊúâÂäπÂåñ'}„Åó„Åæ„Åô„ÅãÔºü" }
                ) %>
          </div>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>