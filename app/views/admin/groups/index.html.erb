<h1>グループ管理</h1>

<!-- 検索バー -->
<div class="mb-3">
  <%= form_with url: admin_groups_path, method: :get, local: true, class: "input-group" do |form| %>
    <%= form.text_field :search, value: params[:search], class: "form-control", placeholder: "グループを検索..." %>
    <%= form.submit "検索", class: "btn btn-primary" %> 
  <% end %>
</div>

<table class="table table-striped table-hover">
  <thead class="table-dark">
    <tr>
      <th style="width: 25%; height: 80px;" class="text-center align-middle">グループ情報</th>
      <th style="width: 20%; height: 80px;" class="text-center align-middle">カテゴリー</th>
      <th style="width: 15%; height: 80px;" class="text-center align-middle">メンバー数</th>
      <th style="width: 20%; height: 80px;" class="text-center align-middle">作成日</th>
      <th style="width: 20%; height: 80px;" class="text-center align-middle">アクション</th>
    </tr>
  </thead>

  <% if @groups.empty? %>
    <div class="alert alert-warning">該当するグループが見つかりませんでした。</div>
  <% end %>

  <tbody>
    <% @groups.each do |group| %>
      <tr>
        <td class="d-flex align-items-center gap-3">
          <% if group.group_image.attached? %>
           　 <%= image_tag group.group_image.variant(resize_to_fill: [50, 50]), class: "rounded-circle border" %>
          <% else %>
           　 <%= image_tag "no_image.jpg", class: "rounded-circle border", width: 50, height: 50 %>
          <% end %>
          　<%= link_to group.name, admin_group_path(group), class: "fw-bold text-dark" %>
        </td>

        <td style="height: 80px;" class="text-center align-middle"><%= I18n.t("enums.group.category.#{group.category}") %></td>
        <td style="height: 80px;" class="text-center align-middle"><%= group.users.count %> 人</td>
        <td style="height: 80px;" class="text-center align-middle"><%= group.created_at.strftime("%Y/%m/%d %H:%M") %></td>

        <td class="text-center">
        <div class="d-flex justify-content-center gap-2">
          <%= link_to "詳細", admin_group_path(group), class: "btn btn-info btn-sm" %>
          <%= link_to "編集", edit_admin_group_path(group), class: "btn btn-warning btn-sm" %>
          <%= link_to "削除", admin_group_path(group), method: :delete, data: { confirm: "⚠️ 本当に削除しますか？ この操作は取り消せません！" }, class: "btn btn-danger btn-sm" %>
        </div>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<!-- グループ作成ボタンを下に移動 -->
<div class="d-flex justify-content-between mt-4">
  <%= link_to "グループ一覧へ戻る", admin_groups_path, class: "btn btn-secondary" %>
  <%= link_to "新しいグループを作成", new_admin_group_path, class: "btn btn-primary" %>
  <%= link_to "管理ダッシュボードへ", admin_dashboard_path, class: "btn btn-outline-primary" %>
</div>